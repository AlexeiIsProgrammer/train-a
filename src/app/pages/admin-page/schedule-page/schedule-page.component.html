@let schedule = scheduleService.schedule$ | async;
@let path = scheduleService.path$ | async;

<mat-accordion class="example-headers-align">
    @for (ride of schedule; track ride.rideId) {
        <mat-expansion-panel #panel [expanded]="$first">
            <mat-expansion-panel-header>
                <mat-panel-description>
                    Ride {{ ride.rideId }}

                    <div>
                        <ng-container #saveBtnContainer />
                        <button
                            mat-icon-button
                            type="button"
                            (click)="remove(ride.rideId); $event.stopPropagation()"
                        >
                            <mat-icon>delete</mat-icon>
                        </button>
                    </div>
                </mat-panel-description>
            </mat-expansion-panel-header>

            @if (panel.expanded) {
                <app-ride
                    #rideSchedule
                    [ride]="ride"
                    [path]="path"
                    (valueChange)="addSaveBtn($index, ride)"
                />
            }
        </mat-expansion-panel>
    }
</mat-accordion>

<ng-template #saveBtn let-ride>
    <button mat-icon-button type="button" (click)="save(ride); $event.stopPropagation()">
        <mat-icon>save</mat-icon>
    </button>
</ng-template>
